<?xml version="1.0" encoding="UTF-8" standalone="no"?>

<project default="qunit-tests"> 

 <property name="src.loc" value="lib"/>

 <target name="init">

	  <property name="dir" value="../test"/>
	  <property name="buildname" value="RiTaJS"/>

	  <property name="${dir}/RiLexicon-tests.html?src=${src.loc}&amp;data=1" value="file3"/>
	
	  <propertyset id="html.tests"><propertyref prefix="${dir}"/></propertyset>

 </target>

 <target name="qunit-tests" depends="init">
	
	  <property name="output.file" value="run-all-tests.html"/>
	  <property name="qunit.js.file" location="run-qunit.js" />
	  <property name="phantomjs.cmd" value="../tools/phantomjs" />
	
	  <apply executable="${phantomjs.cmd}" failonerror="false" verbose="true">
	 
	  <arg value="${qunit.js.file}"/>
	  
	  <srcfile/>
	  
	  <propertyset refid="html.tests"/>
	
	  </apply>

 </target>
 
 <target name="sendmail">
	   <mail
	      tolist="dh254@nyu.edu, dhowe@risd.edu"
	      from="daniel.c.howe@gmail.com"
	      subject="[RiTaJS] Results of auto-build"
	      mailhost="smtp.gmail.com"
	      mailport="465" ssl="true"
	      user=""
	      password="">
	      
	      <message>The ${buildname} nightly build has completed</message>
	        
	      <attachments>
	        <fileset dir=".">
	          <include name="tests-err.txt"/>
	        </fileset>
	      </attachments>
	      
   </mail>
</target>

</project>
